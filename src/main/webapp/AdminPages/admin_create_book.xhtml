<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition template="./admin_template.xhtml">
        <ui:define name="title">
            <h:outputText value="Create a Book"></h:outputText>
        </ui:define>

        <ui:define name="body">
            <section class="content-header">
                <h1>
                    Create a Book 
                </h1>

                <ol class="breadcrumb">
                    <li><a href="admin_home.xhtml"><i class="fa fa-dashboard"></i> Home</a></li>
                    <li><a href="admin_books.xhtml"><i class="fa fa-dashboard"></i> Inventory</a></li>
                    <li><a href="#"><i class="fa fa-dashboard"></i> Create</a></li>
                </ol>
            </section>
            <br/>
            <section class="content">
                <div class="container">
                    <h:form id="theForm">
                        <div class="row row-centered">
                            <div class="col-md-4"><b>Title</b></div>
                            <div class="col-md-4">
                                <p:inputText id="title" value="#{booksBB.newBook.title}" required="true" requiredMessage="Title is required">
                                    <f:validateLength maximum="128"/>
                                    <f:ajax event="blur" render="titleErr"/>
                                </p:inputText>
                            </div>
                            <div class="col-md-4"><h:message for="title" id="titleErr" errorStyle="color:red; display:block"/></div>
                        </div>
                        <br/>
                        <div class="row row-centered">
                            <div class="col-md-4"><b>Publisher</b></div>
                            <div class="col-md-4">
                                <p:inputText id="publisher" value="#{booksBB.newBook.publisher}" required="true" requiredMessage="Publisher is required">
                                    <f:validateLength maximum="128"/>
                                    <f:ajax event="blur" render="publisherErr"/>
                                </p:inputText>
                            </div>
                            <div class="col-md-4">
                                <h:message for="publisher" id="publisherErr" errorStyle="color:red; display:block"/>
                            </div>
                        </div>
                        <br/>
                        <div class="row row-centered">
                            <div class="col-md-4"><b>Description</b></div>
                            <div class="col-md-4">
                                <p:inputTextarea id="description" value="#{booksBB.newBook.description}" required="true" requiredMessage="Description is required">
                                    <f:ajax event="blur" render="descriptionErr"/>
                                </p:inputTextarea>
                            </div>
                            <div class="col-md-4">
                                <h:message for="description" id="descriptionErr" errorStyle="color:red; display:block"/>
                            </div>
                        </div>
                        <br/>
                        <div class="row row-centered">
                            <div class="col-md-4"><b>Publication Date</b></div>
                            <div class="col-md-4">
                                <p:calendar id="publish_date" value="#{booksBB.newBook.pubDate}" required="true" requiredMessage="Publication date is required">
                                    <f:ajax event="blur" render="pubDateErr"/>
                                </p:calendar>
                            </div>
                            <div class="col-md-4">
                                <h:message for="publish_date" id="pubDateErr" errorStyle="color:red; display:block"/>
                            </div>
                        </div>
                        <br/>
                        <div class="row row-centered">
                            <div class="col-md-4"><b>Number of Page</b></div>
                            <div class="col-md-4">
                                <p:inputText id="page_number" value="#{booksBB.newBook.pages}" required="true" requiredMessage="Number of pages is required">
                                    <f:convertNumber integerOnly="true"/>
                                    <f:validateLength minimum="1" maximum="11"/>
                                    <f:ajax event="blur" render="numPagesErr"/>
                                </p:inputText>
                            </div>
                            <div class="col-md-4">
                                <h:message for="page_number" id="numPagesErr" errorStyle="color:red; display:block"/>
                            </div>
                        </div>
                        <br/>
                        <div class="row row-centered">
                            <div class="col-md-4"><b>Wholesale Price</b></div>
                            <div class="col-md-4">
                                <p:inputText id="wholesale_price" value="#{booksBB.newBook.wholesalePrice}" required="true" requiredMessage="Wholesale price is required">
                                    <f:convertNumber maxFractionDigits="2"/>
                                    <f:validateLongRange minimum="0"/>
                                    <f:validateLength minimum="1" maximum="12"/>
                                    <f:ajax event="blur" render="wholesaleErr"/>
                                </p:inputText>
                            </div>
                            <div class="col-md-4">
                                <h:message for="wholesale_price" id="wholesaleErr" errorStyle="color:red; display:block"/>
                            </div>
                        </div>
                        <div class="row row-centered">
                            <div class="col-md-4"><b>List Price</b></div>
                            <div class="col-md-4">
                                <p:inputText id="list_price" value="#{booksBB.newBook.listPrice}" required="true" requiredMessage="List price is required">
                                    <f:convertNumber maxFractionDigits="2"/>
                                    <f:validateLongRange minimum="0"/>
                                    <f:validateLength minimum="1" maximum="12"/>
                                    <f:ajax event="blur" render="listErr"/>
                                </p:inputText>
                            </div>
                            <div class="col-md-4">
                                <h:message for="list_price" id="listErr" errorStyle="color:red; display:block"/>
                            </div>
                        </div>
                        <div class="row row-centered">
                            <div class="col-md-4"><b>Sale Price</b></div>
                            <div class="col-md-4">
                                <p:inputText id="sale_price" value="#{booksBB.newBook.salePrice}" required="true" requiredMessage="Sale price is required">
                                    <f:convertNumber maxFractionDigits="2"/>
                                    <f:validateLongRange minimum="0"/>
                                    <f:validateLength minimum="1" maximum="12"/>
                                    <f:ajax event="blur" render="saleErr"/>
                                </p:inputText>
                            </div>
                            <div class="col-md-4">
                                <h:message for="sale_price" id="saleErr" errorStyle="color:red; display:block"/>
                            </div>
                        </div>
                        <br/>
                        <div class="row row-centered">
                            <div class="col-md-4"><b>Removal Status</b></div>
                            <div class="col-md-4">
                                <p:selectOneRadio id="available" layout="lineDirection" value="#{booksBB.newBook.removalStatus}">
                                    <f:selectItem itemValue="True" itemLabel="True" />
                                    <f:selectItem itemValue="False" itemLabel="False" />
                                </p:selectOneRadio>
                            </div>
                            <div class="col-md-4"><h:message for="available" errorStyle="color:red; display:block"/></div>
                        </div>
                        <br/>
                        <div class="row row-centered">
                            <div class="col-md-4"><b>Genre</b></div>
                            <div class="col-md-4">
                                <p:selectCheckboxMenu id="menuGenre" value="#{booksBB.newGenres}" label="Genres"
                                                      filter="true" filterMatchMode="startsWith">
                                    <f:selectItems value="#{booksBB.allGenre}" var="theGenre" itemLabel="#{theGenre.type}" itemValue="#{theGenre.type}"/>
                                </p:selectCheckboxMenu>
                                <br/>
                                <p:commandButton value="Add" update="displayGenre" />
                            </div>
                            <div class="col-md-4">
                                <p:outputPanel id="displayGenre">
                                    <p:dataList value="#{booksBB.newGenres}" var="theGenre" emptyMessage="No Genres added" type="definition">
                                        <f:facet name="header">
                                            Genres
                                        </f:facet>
                                        <p:commandLink update="theForm" action="#{booksBB.removeGenre(theGenre)}" title="Delete" styleClass="ui-icon ui-icon-closethick" style="float:left;margin-right:10px"/>
                                        <h:outputText value="#{theGenre}"/>
                                    </p:dataList>
                                </p:outputPanel> 
                            </div>
                        </div>
                        <br/>

                        <div class="row row-centered">
                            <div class="col-md-4"><b>Formats</b></div>
                            <p:outputPanel id="formatForm">
                                <div class="col-md-4">
                                    <p:selectOneMenu id="menuFormat" value="#{booksBB.newFormat}" label="Formats">
                                        <f:selectItems value="#{booksBB.allFormats}" var="theFormat" itemLabel="#{theFormat.type}" itemValue="#{theFormat.type}"/>
                                    </p:selectOneMenu>
                                    <br/>
                                    <h:outputText value="File name (eg. file.pdf)"/>
                                    <br/>
                                    <p:inputText id="file" value="#{booksBB.newFile}"/>
                                    <br/>
                                    <p:commandButton value="Add" update="displayFormat formatForm" action="#{booksBB.createBookFormat()}"/>
                                </div>
                                <div class="col-md-4">
                                    <p:outputPanel id="displayFormat">
                                        <p:dataList value="#{booksBB.newBookFormatList}" var="theBookFormat" emptyMessage="No Formats added" type="definition">
                                            <f:facet name="header">
                                                Formats
                                            </f:facet>
                                            <p:commandLink update="theForm" action="#{booksBB.removeBookFormat(theBookFormat)}" title="Delete" styleClass="ui-icon ui-icon-closethick" style="float:left;margin-right:10px"/>
                                            <h:outputText value="#{theBookFormat.format1.type} - #{theBookFormat.file}"/>
                                        </p:dataList>
                                    </p:outputPanel>
                                </div>
                            </p:outputPanel>
                        </div>
                        <br/>

                        <div class="row row-centered">
                            <div class="col-md-4"><b>Identifiers</b></div>
                            <p:outputPanel id="identifierForm">
                                <div class="col-md-4">
                                    <p:selectOneMenu id="menuIdentifier" value="#{booksBB.newIdentifierType}" label="Identifiers">
                                        <f:selectItems value="#{booksBB.allIdentifierTypes}" var="theIdentType" itemLabel="#{theIdentType.type}" itemValue="#{theIdentType.type}"/>
                                    </p:selectOneMenu>
                                    <br/>
                                    <h:outputText value="Code"/>
                                    <br/>
                                    <p:inputText id="code" value="#{booksBB.newCode}"/>
                                    <br/>
                                    <p:commandButton value="Add" update="displayIdentifier identifierForm" action="#{booksBB.createBookIdentifier()}"/>
                                </div>
                                <div class="col-md-4">
                                    <p:outputPanel id="displayIdentifier">
                                        <p:dataList value="#{booksBB.newBookIdentifierList}" var="theBookIdentifier" emptyMessage="No Identifiers added" type="definition">
                                            <f:facet name="header">
                                                Identifiers
                                            </f:facet>
                                            <p:commandLink update="theForm" action="#{booksBB.removeBookIdentifier(theBookIdentifier)}" title="Delete" styleClass="ui-icon ui-icon-closethick" style="float:left;margin-right:10px"/>
                                            <h:outputText value="#{theBookIdentifier.identifierType.type} - #{theBookIdentifier.code}"/>
                                        </p:dataList>
                                    </p:outputPanel>
                                </div>
                            </p:outputPanel>
                        </div>
                        <br/>
                        <div class="row row-centered">
                            <div class="col-md-4"><b>Contributors</b></div>
                            <p:outputPanel id="contributorForm">
                                <div class="col-md-4">
                                    <p:selectOneMenu id="menuContributionType" value="#{booksBB.newContributionType}" label="ContributionTypes">
                                        <f:selectItems value="#{booksBB.allContributionType}" var="contribType" itemLabel="#{contribType.type}" itemValue="#{contribType.type}"/>
                                    </p:selectOneMenu>
                                    <br/>
                                    <h:outputText value="Full Name"/>
                                    <br/>
                                    <p:inputText id="fulName" value="#{booksBB.newContributorName}"/>
                                    <br/>
                                    <p:commandButton value="Add" update="displayContributors contributorForm" action="#{booksBB.createContributor()}"/>
                                </div>
                                <div class="col-md-4">
                                    <p:outputPanel id="displayContributors">
                                        <p:dataList value="#{booksBB.newContributorList}" var="theContributor" emptyMessage="No Contributors added" type="definition">
                                            <f:facet name="header">
                                                Contributors
                                            </f:facet>
                                            <p:commandLink update="theForm" action="#{booksBB.removeContributor(theContributor)}" title="Delete" styleClass="ui-icon ui-icon-closethick" style="float:left;margin-right:10px"/>
                                            <h:outputText value="#{theContributor.contribution.type} - #{theContributor.name}"/>
                                        </p:dataList>
                                    </p:outputPanel>
                                </div>
                            </p:outputPanel>
                        </div>


                        <div class="row row-centered">
                            <div class="col-md-12">
                                <p:commandButton value="Create" action="#{booksBB.createBook()}" class="btn btn-primary btn-xs"/>
                            </div>
                            <br/>
                            <div class="col-md-6">
                                <p:commandButton value="Cancel" action="#{booksBB.cancel()}" class="btn btn-danger btn-xs" immediate="true"/>
                            </div>
                        </div>
                    </h:form>
                </div>
            </section>

        </ui:define>
    </ui:composition>
</html>